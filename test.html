<!DOCTYPE html>
<html>
<head>
<style>

table {
  position: absolute;
  height: 98%;
  width: 99%;
  z-index: -1;
}

table, th, td {
  border: 1px solid black;
}

td {
  text-align: center;
  vertical-align: middle;
}

table, td, th {
  border:1px solid green;
}

th {
  background-color:green;
  color:white;
}

</style>
</head>
<body>
<script src='bower_components/requirejs/require.js' charset='utf-8'></script>
<script>

require.config({
  baseUrl: './',
  paths: {
    d3: 'bower_components/d3/d3'
  },
  shim: {
    d3: { exports: 'd3' }
  },
  waitSeconds: 5
});

require(['d3', 'd4'], function(d3, d4) {

var tableData = [
  ['here', 'is',        'johnny'],
  ['blah', 'bloop',     'blee'],
  ['merg', 'samsonite', 'luggage']
];

var tableSpec = d4('table')
  .children(
    d4('tr').children(
      d4('th').merge(function (th, d) { return th.html(d); })
    ), function (rows) { return [rows[0]]; })
  .children(
    d4('tr').children(
      d4('td').merge(function (td, d) { return td.html(d); })
    ), function (rows) { return rows.slice(1); });

function renderTable() {
  tableSpec.render(d3.select('body'), [tableData], 'myTable');
}

var boxSpec = d4('rect')
  .enter(function (rect, d) {
    return rect
      .attr('x', d.bounds[0])
      .attr('y', d.bounds[1])
      .attr('width', d.bounds[2])
      .attr('height', d.bounds[3])
      .attr('fill', d.color)
      .attr('opacity', 0.5)
      ;
  })
  ;

var ellipSpec = d4('ellipse')
  .enter(function(ellipse, d) {
    return ellipse
      .attr('fill', d.color)
      ;
  })
  .merge(function(ellipse, d) {
    var rx = d.bounds[2] / 2;
    var ry = d.bounds[3] / 2;
    return ellipse
      .transition()
      .duration(1000)
      .attr('cx', d.bounds[0] + rx)
      .attr('cy', d.bounds[1] + ry)
      .attr('rx', rx)
      .attr('ry', ry)
      .attr('fill', d.color)
      .attr('opacity', 0.3)
      ;
  })
  ;

var data = {
  bounds: [200,250,100,45],
  color: 'blue'
};

function renderBoxAndEllipse() {
  d4('svg')
    .child(boxSpec)
    .child(ellipSpec)
    .render(d3.select('body'), [data], 'boxAndCircle')
    ;
}

renderTable();
renderBoxAndEllipse();

setTimeout(function () {
  data.bounds[0] += 200;
  data.bounds[1] += 50;
  data.bounds[2] += 400;
  data.bounds[3] += 100;
  data.color = 'red';
  renderBoxAndEllipse();

  tableData[1][1] = 'TWIST!';
  renderTable();

}, 2000);

});

</script>
</body>
</html>